@page "/bingo"

@using PictureBingo.Data

@inject BingoService BingoService

<h1>Bingoooo!</h1> 
<button class="btn btn-primary" @onclick=DrawNumber>Trek een plaatje</button>
<div> 
    <h2>Laatste plaatje: @LastDrawnNumber?.Name</h2>
     <br/>
        @if(LastDrawnNumber != null){
            <img src=@LastDrawnNumber?.Path class="paw-patrol big" />
        }
</div>
<div id=drawnnumber>
    <p>
        Getrokken :
    </p>
    <ul>
        @foreach (var number in drawnNumbers)
        {
            <li style="list-style-type:none"><img src=@number.Path class="paw-patrol" /></li>
        }
    </ul>
</div>

<div id=numbers>
    Beschikbaar:
    <ul>
        @foreach (var number in availableNumbers)
        {
            <li>@number.Name</li>
        }
    </ul>
</div>

@code {
    List<BingoData> availableNumbers;
    
    List<BingoData> drawnNumbers = new List<BingoData>();

    BingoData LastDrawnNumber;

    protected override async Task OnInitializedAsync()
    {
        availableNumbers = await BingoService.GetBingoData();
    }

    private void DrawNumber() {
        if (availableNumbers.Count == 0)
            return;

        Random r = new Random();
        var drawnNumber = availableNumbers.OrderBy(n => r.Next()).First();

        drawnNumbers.Add(drawnNumber);
        availableNumbers.Remove(drawnNumber);
        LastDrawnNumber = drawnNumber;
    }
}